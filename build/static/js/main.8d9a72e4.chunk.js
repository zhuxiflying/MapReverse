(this.webpackJsonpmapreverse=this.webpackJsonpmapreverse||[]).push([[0],{153:function(e,t,a){},154:function(e,t,a){},195:function(e,t,a){e.exports=a(411)},221:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},403:function(e,t,a){},404:function(e,t,a){},405:function(e,t,a){},409:function(e,t,a){},410:function(e,t,a){},411:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(59),l=a.n(c),i=a(13),o=a(14),s=a(16),u=a(15),m=a(17),d=a(87),f=a.n(d),p=a(155),h=a(156),E=a.n(h),g=(a(63),function(e){var t=e.onClickBack;return r.a.createElement("div",{className:"back-icon",onClick:function(){return t()}},r.a.createElement("img",{className:"icon-img",src:"data\\backIcon.png",alt:""}))}),y=function(e){var t=e.data,a=(e.colorScale,e.selectedImage),n=e.selectedEntity,c=e.selectedDomain,l=e.onClickIcon,i=t.entity,o=t.Domain,s=null===i?[]:Object.keys(i),u=null!==a&&a.Id===t.Id?"icon-div-focus":"icon-div";return(s.includes(n)||o===c)&&(u+=" icon-div-selected"),r.a.createElement("div",{className:u,onClick:function(){return l(t)}},r.a.createElement("img",{className:"icon-img",src:"data\\"+t.Image_url+".jpg",alt:""}))},k=(a(221),function(e){var t=e.onClickOrigin,a=e.mapId;return r.a.createElement("div",{className:"origin-icon",onClick:function(){return t()}},r.a.createElement("img",{className:"icon-img",src:"data\\"+a+"\\icon.png",alt:""}))}),v=function(e){var t=e.data,a=e.mapId,n=e.colorScale,c=e.selectedImage,l=e.selectedEntity,i=e.selectedDomain,o=e.onClickIcon,s=e.onClickBack,u=e.onClickOrigin;return r.a.createElement("div",{className:"icon-container"},r.a.createElement(g,{onClickBack:s}),r.a.createElement(k,{onClickOrigin:u,mapId:a}),t.map((function(e){return r.a.createElement(y,{key:e.Id,data:e,colorScale:n,selectedImage:c,selectedEntity:l,selectedDomain:i,onClickIcon:o})})))},b=a(11),C=(a(153),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.x,a=e.y,n=e.payload;return r.a.createElement("g",{transform:"translate(".concat(t,",").concat(a,")")},r.a.createElement("text",{x:0,y:0,dy:16,className:"small",textAnchor:"middle"},n.value))}}]),t}(n.PureComponent)),I=a(90),O=a(47),j=a(9),D=a(166);function S(e){var t={},a=Object(I.a)(e);return function(e){e.sort((function(e,t){return new Date(e.Crawl_Date)-new Date(t.Crawl_Date)}))}(a),a.forEach((function(e){var a=e.Crawl_Date,n=e.Score,r=N(a);t[r]?(t[r][0]++,t[r][1]+=n):(t[r]=[],t[r][0]=1,t[r][1]=n)})),Object.entries(t).map((function(e){var t=Object(O.a)(e,2),a=t[0],n=t[1];return{date:a,frequency:n[0],score:n[1]/n[0]}}))}function N(e){var t=new Date(e),a=t.getMonth()+1;return t.getFullYear()+"-"+a}function w(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+(e.getDate()+1)}var B=function(e){var t=e.data,a=e.selectedBar,n=e.onClickBar,c=e.colorScale,l=S(t);return r.a.createElement("div",{className:"timeChart-container"},r.a.createElement(b.d,{height:"100%",width:"100%"},r.a.createElement(b.b,{data:l,margin:{top:10,right:10,bottom:10,left:0}},r.a.createElement(b.e,{dataKey:"date",axisLine:!1,tick:r.a.createElement(C,null),stroke:"black"}),r.a.createElement(b.f,{stroke:"black",tick:{fontSize:"1rem"}}),r.a.createElement(b.a,{dataKey:"frequency",stackId:"a",maxBarSize:100,onClick:n},l.map((function(e,t){return r.a.createElement(b.c,{cursor:"pointer",fill:c(e.score),stroke:e.date===a?"#8884d8":null,strokeWidth:"4",key:"cell-".concat(t)})}))))))},M=(a(401),a(46));function q(e){var t=e.handle,a=t.id,n=(t.value,t.percent),c=e.getHandleProps;return r.a.createElement("div",Object.assign({style:{left:"".concat(n,"%"),position:"absolute",marginLeft:-10,marginTop:-5,zIndex:2,width:20,height:20,border:0,textAlign:"center",cursor:"pointer",borderRadius:"50%",backgroundColor:"#636363"}},c(a)))}function x(e){var t=e.source,a=e.target,n=e.getTrackProps;return r.a.createElement("div",Object.assign({style:{position:"absolute",height:10,zIndex:1,backgroundColor:"#8884d8",borderRadius:5,cursor:"pointer",left:"".concat(t.percent,"%"),width:"".concat(a.percent-t.percent,"%")}},n()))}a(402);var _=function(e){var t=e.scoresRange,a=e.handleChange;return r.a.createElement(M.c,{className:"silder",values:t,onChange:a,domain:[0,100],step:1,mode:2},r.a.createElement(M.b,null,(function(e){var t=e.getRailProps;return r.a.createElement("div",Object.assign({className:"rail"},t()))})),r.a.createElement(M.a,null,(function(e){var t=e.handles,a=e.getHandleProps;return r.a.createElement("div",{className:"slider-handles"},t.map((function(e){return r.a.createElement(q,{key:e.id,handle:e,getHandleProps:a})})))})),r.a.createElement(M.d,{left:!1,right:!1},(function(e){var t=e.tracks,a=e.getTrackProps;return r.a.createElement("div",{className:"slider-tracks"},t.map((function(e){var t=e.id,n=e.source,c=e.target;return r.a.createElement(x,{key:t,source:n,target:c,getTrackProps:a})})))})))},R=function(e){var t=e.data,a=e.colorScale,n=function(e){for(var t=[],a=1;a<=50;a++)t.push(a);var n={};return e.forEach((function(e){var t=e.Score,a=Math.ceil(t/2);n[a]?n[a]++:n[a]=1})),t.map((function(e){return{label:2*e,frequency:n[e]||0}}))}(t);return r.a.createElement(b.d,{height:"80%",width:"100%"},r.a.createElement(b.b,{data:n,barCategoryGap:1,margin:{top:10,right:0,bottom:0,left:0}},r.a.createElement(b.a,{dataKey:"frequency"},n.map((function(e,t){return r.a.createElement(b.c,{fill:a(e.label),key:"cell-".concat(t)})})))))},T=(a(403),function(e){var t=e.data,a=e.colorScale,n=e.scoresRange,c=e.handleChange;return r.a.createElement("div",{className:"scoreFilter-container"},r.a.createElement(R,{data:t,colorScale:a}),r.a.createElement(_,{scoresRange:n,handleChange:c}))}),F=a(26),P=(a(404),function(e){var t=e.entity,a=e.scale,n=e.onClickEntity,c=e.selected,l=e.focused,i=t.key,o="entity-div";c?o+=" entity-div-selected":l&&(o+=" entity-div-focused");var s={backgroundColor:a(t.frequency)};return r.a.createElement("div",{className:o,style:s,onClick:function(){return n(i)}},i)}),A=(a(405),function(e){var t=e.data,a=e.onClickEntity,n=e.selectedImage,c=e.selectedEntity,l=function(e){var t={},a=[];return e.forEach((function(e){var a=e.entity;null!==a&&Object.entries(a).forEach((function(e){var a=Object(O.a)(e,2),n=a[0];a[1];""!==n&&(t[n]||(t[n]=1),t[n]++)}))})),(a=Object.entries(t).map((function(e){var t=Object(O.a)(e,2);return{key:t[0],frequency:t[1]}}))).sort((function(e,t){return t.frequency-e.frequency})),a}(t),i=null===n||null===n.entity?[]:Object.keys(n.entity),o=function(e){if(0===e.length)return null;var t=["#fed976","#feb24c","#fd8d3c","#fc4e2a"],a=e.map((function(e){return e.frequency})),n=Object(D.ckmeans)(a,t.length).map((function(e){return Math.max.apply(Math,Object(I.a)(e))})).slice(0,-1);return Object(j.scaleThreshold)().domain(n).range(t)}(l);return r.a.createElement("div",{className:"entity-container"},l.map((function(e){return r.a.createElement(P,{key:e.key,entity:e,scale:o,onClickEntity:a,selected:c===e.key,focused:i.includes(e.key)})})))}),z=(a(406),a(154),a(407),a(408),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sortColumn:"date"},a.onSort=function(e){a.setState({sortColumn:e})},a.sortByColumn=function(e){return"frequency"===a.state.sortColumn?a.sortByFrequency(e):"date"===a.state.sortColumn?a.sortByDate(e):void 0},a.sortByFrequency=function(e){return e.sort((function(e,t){return t.frequency-e.frequency}))},a.sortByDate=function(e){return e.sort((function(e,t){return new Date(e.date)-new Date(t.date)}))},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.onCheckDomain,c=t.selectedDomain,l=this.state.sortColumn,i=function(e){var t={};return e.forEach((function(e){var a=e.Domain,n=e.Crawl_Date,r=new Date(n);t[a]?(r<t[a][0]&&(t[a][0]=r),t[a][1]++):(t[a]=[],t[a][0]=r,t[a][1]=1)})),Object.entries(t).map((function(e){var t=Object(O.a)(e,2),a=t[0],n=t[1];return{key:a,frequency:n[1],date:w(n[0])}}))}(a),o=this.sortByColumn(i);return r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Domain"),r.a.createElement("th",{onClick:function(){return e.onSort("frequency")},className:"tableHead"},"Frequency"," ","frequency"===l&&r.a.createElement("i",{className:"fa fa-arrow-down","aria-hidden":"true"})),r.a.createElement("th",{onClick:function(){return e.onSort("date")},className:"tableHead"},"First found on"," ","date"===l&&r.a.createElement("i",{className:"fa fa-arrow-down","aria-hidden":"true"})))),r.a.createElement("tbody",null,o.map((function(e){return r.a.createElement("tr",{key:e.key},r.a.createElement("td",null,r.a.createElement("input",{type:"checkbox",onChange:function(){return n(e.key)},checked:e.key===c})),r.a.createElement("td",null,e.key),r.a.createElement("td",null,e.frequency),r.a.createElement("td",null,e.date))}))))}}]),t}(n.Component)),H=function(e){var t=e.data,a=e.onClickEntity,n=e.onCheckDomain,c=e.selectedImage,l=e.selectedEntity,i=e.selectedDomain;return r.a.createElement(F.d,{className:"analysisTab-container"},r.a.createElement(F.b,null,r.a.createElement(F.a,null,"Entities"),r.a.createElement(F.a,null,"Domains")),r.a.createElement(F.c,null,r.a.createElement(A,{key:"entityContainer",data:t,selectedImage:c,selectedEntity:l,onClickEntity:a})),r.a.createElement(F.c,null,r.a.createElement(z,{key:"domainContainer",data:t,selectedDomain:i,onCheckDomain:n})))},L=function(e){var t=e.url;return r.a.createElement("img",{className:"origin-img",src:t,alt:""})},G=function(e){var t=e.selectedImage,a=e.colorScale,n=t.Score,c=t.Crawl_Date,l=t.Link,i=t.Domain;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"The original image was first found on ",r.a.createElement("b",null,c)," at"," ",r.a.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer"},i)," ","."),r.a.createElement("p",null,"The similarity score is"," ",r.a.createElement("span",{style:{color:a(n),fontWeight:"bold"}},n),"."))},K=(a(409),function(e){var t=e.selectedImage,a=e.colorScale,n=e.mapId,c=null;if(null===t)c="data\\"+n+"\\"+n+".jpg";else{var l=t.OriginImage;c=void 0===l?"data\\noImage.jpg":"data\\"+l}return r.a.createElement("div",{className:"info-container"},r.a.createElement("div",{className:"originImage"},r.a.createElement(L,{url:c})),r.a.createElement("div",{className:"textPanel"},null===t?r.a.createElement("p",null,"This is the input image."):r.a.createElement(G,{selectedImage:t,colorScale:a})))}),J=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mapId:a.props.mapId,data:[],selectedImage:null,selectedBar:"",selectedEntity:null,selectedDomain:null,scoresRange:[0,100]},a.handleIconClick=function(e){var t=a.state.selectedImage===e?null:e;a.setState({selectedImage:t})},a.handleOriginClick=function(){a.setState({selectedImage:null})},a.handleBarClick=function(e){var t=a.state.selectedBar===e.date?"":e.date;a.setState({selectedBar:t})},a.handleEntityClick=function(e){var t=e===a.state.selectedEntity?null:e;a.setState({selectedEntity:t})},a.handleDomainOnCheck=function(e){var t=e===a.state.selectedDomain?null:e;a.setState({selectedDomain:t})},a.handleSilderChange=function(e){a.setState({scoresRange:e})},a.filterDataByDate=function(e,t){return e.filter((function(e){return N(e.Crawl_Date)===t}))},a.filterDataByEntity=function(e,t){return e.filter((function(e){var a=e.entity;return(null===a?[]:Object.keys(a)).includes(t)}))},a.filterDataByScore=function(e,t){return e.filter((function(e){var a=e.Score;return a>=t[0]&&a<=t[1]}))},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(p.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("data/"+this.state.mapId+"/matches.json");case 2:t=e.sent,a=t.data,this.setState({data:a,filtered:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.data,a=e.mapId,n=e.scoresRange,c=e.selectedImage,l=e.selectedBar,i=e.selectedEntity,o=e.selectedDomain,s=this.props.onClickBack,u=""===l?t:this.filterDataByDate(t,l),m=this.filterDataByScore(u,n),d=function(e){var t=e.map((function(e){return e.Score})).sort((function(e,t){return e-t}));return Object(j.scaleQuantile)().domain(t).range(["#feebe2","#fbb4b9","#f768a1","#ae017e"])}(t);return r.a.createElement("div",{className:"grid-container"},r.a.createElement("div",{className:"mapContainer"},r.a.createElement(v,{key:"iconContainer",data:m,mapId:a,colorScale:d,selectedImage:c,selectedEntity:i,selectedDomain:o,onClickIcon:this.handleIconClick,onClickOrigin:this.handleOriginClick,onClickBack:s})),r.a.createElement("div",{className:"imageContainer"},r.a.createElement(K,{selectedImage:c,colorScale:d,mapId:a})),r.a.createElement("div",{className:"scoreFilter"},r.a.createElement(T,{key:"scoreFilter",data:t,scoresRange:n,colorScale:d,handleChange:this.handleSilderChange})),r.a.createElement("div",{className:"timeChart"},r.a.createElement(B,{key:"timeBarChart",data:t,selectedBar:l,colorScale:d,onClickBar:this.handleBarClick})),r.a.createElement("div",{className:"analysisTab"},r.a.createElement(H,{key:"analysisTab",data:m,selectedImage:c,selectedEntity:i,onClickEntity:this.handleEntityClick,onCheckDomain:this.handleDomainOnCheck,selectedDomain:o})))}}]),t}(n.Component),V=function(){return r.a.createElement("div",null,r.a.createElement("img",{className:"logo-img",src:"data\\\\Logo.jpg",alt:""}))},W=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement("b",null,"MapReverse")," is a project prototype built by"," ",r.a.createElement("a",{href:"https://github.com/zhuxiflying/MapReverse",target:"_blank",rel:"noopener noreferrer"},"Xi Zhu")," ","and"," ",r.a.createElement("a",{href:"https://sites.psu.edu/arobinson/",target:"_blank",rel:"noopener noreferrer"},"Anthony Robinson")," ","at"," ",r.a.createElement("a",{href:"https://www.geovista.psu.edu/",target:"_blank",rel:"noopener noreferrer"},"the GeoVISTA Center")," ","in the Department of Geography at Penn State University. MapReverse is designed to help explore maps shared in social media to uncover their potential sources and derivatives. MapReverse combines machine learning services for reverse image search with visualizations to make it possible for users to better understand the characteristics and dissemination of maps in social media. Please refer to"," ",r.a.createElement("a",{href:"https://www.researchgate.net/publication/325181270_Elements_of_Viral_Cartography",target:"_blank",rel:"noopener noreferrer"},"our recent article")," ","for more information, or you can contact ",r.a.createElement("i",null,"arobinsonATpsu.edu")))},Y=function(e){var t=e.mapId,a=e.onClickMap;return r.a.createElement("div",{className:"map-image-container",onClick:function(){return a(t)}},r.a.createElement("img",{className:"map-image",src:"data\\"+t+"\\"+t+".jpg",alt:""}))},Q=function(e){var t=e.onClickMap;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{mapId:"test15",onClickMap:t}),r.a.createElement(Y,{mapId:"test20",onClickMap:t}),r.a.createElement(Y,{mapId:"test9",onClickMap:t}),r.a.createElement(Y,{mapId:"test2",onClickMap:t}),r.a.createElement(Y,{mapId:"test3",onClickMap:t}),r.a.createElement(Y,{mapId:"test4",onClickMap:t}),r.a.createElement(Y,{mapId:"test5",onClickMap:t}),r.a.createElement(Y,{mapId:"test8",onClickMap:t}))},U=(a(410),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.onClickMap;return r.a.createElement("div",{className:"gallary-container"},r.a.createElement("div",{className:"log-container"},r.a.createElement(V,null)),r.a.createElement("div",{className:"map-container"},r.a.createElement(Q,{onClickMap:e})),r.a.createElement("div",{className:"text-container"},r.a.createElement(W,null)))}}]),t}(n.Component)),X=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mapId:null},a.handleBackClick=function(){a.setState({mapId:null})},a.handleMapClick=function(e){a.setState({mapId:e})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return null===this.state.mapId?r.a.createElement(U,{onClickMap:this.handleMapClick}):r.a.createElement(J,{mapId:this.state.mapId,onClickBack:this.handleBackClick})}}]),t}(n.Component);l.a.render(r.a.createElement(X,null),document.getElementById("root"))},63:function(e,t,a){}},[[195,1,2]]]);
//# sourceMappingURL=main.8d9a72e4.chunk.js.map